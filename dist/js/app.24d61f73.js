webpackJsonp([1],{"+VGo":function(e,t){},0:function(e,t,a){e.exports=a("NHnr")},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("/5sW"),o=a("zL8q"),l=a.n(o),i=(a("uMhA"),a("tvR6"),a("EuXz"),a("mw3O")),s=a("XinO"),r=a.n(s),d={name:"home",data:function(){return{loading:!1,smallLoading:!1,searchLoading:!1,address:"",inputName:"",file:"",url:"http://localhost:8080",tableData:[],downloadTableData:[]}},computed:{uploadLink:function(){return""===this.file&&0===this.tableData.length},upChainText:function(){return this.smallLoading?"上链中...":"信息上链"},showDownload:function(){return""!==this.inputName&&0!==this.downloadTableData.length},searchText:function(){return this.searchLoading?"搜索中...":"搜索"}},methods:{uploadFunc:function(e,t,a){var n=this,o=new FormData;o.append("file",e.file),o.append("action","test"),this.loading=!0,this.$http({method:"post",url:"upload/uploadfile",data:o}).then(function(t){n.loading=!1,t.data&&(n.file=e.file.name,n.tableData=t.data.rows)}).catch(function(e){n.loading=!1,n.$message.error("上传失败"),console.log(e)})},uploadToChain:function(){var e=this;this.smallLoading=!0,this.address="",this.$http({method:"post",url:"/upload/uploadToChain",data:Object(i["stringify"])({filename:this.file,fragmentHashList:JSON.stringify(this.tableData)})}).then(function(t){e.smallLoading=!1,t.data&&t.data.result&&(e.address=t.data.address)}).catch(function(t){e.smallLoading=!1,e.$message.error(t.message),console.log(t)})},handleRemove:function(e,t){this.file="",this.tableData=[],this.address=""},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},handleSearch:function(){var e=this;if(""===this.inputName)return this.$message.error("请输入文件名"),!1;this.searchLoading=!0,this.$http({method:"post",url:"/download/checkfile",data:Object(i["stringify"])({filename:this.inputName})}).then(function(t){e.searchLoading=!1,t.data.result&&t.data.fragmentHashList?e.downloadTableData=t.data.fragmentHashList:e.$message.error("无查找结果")}).catch(function(t){e.searchLoading=!1,e.$message.error(t.message),console.log(t)})},handleDownload:function(){this.downloadPost({url:this.url+"/download/downloadfile",data:{filename:this.inputName}})},downloadPost:function(e){var t=e.url,a=e.data,n=document.createElement("form");n.action=t,n.method="post",n.style.display="none",Object.keys(a).forEach(function(e){var t=document.createElement("input");t.name=e,t.value=a[e],n.appendChild(t)});var o=document.createElement("input");o.type="submit",n.appendChild(o),document.body.appendChild(n),n.submit(),document.body.removeChild(n)},handleCopy:function(){var e=r()(this.file);e&&this.$message.success("文件名已复制")},handleExceed:function(){this.$message.error("请先移除旧文件")}}},c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{staticClass:"container",attrs:{type:"border-card"}},[a("el-tab-pane",{staticClass:"upload-page",attrs:{label:"文件上传"}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("el-upload",{staticClass:"upload-demo",attrs:{limit:1,action:e.url,"http-request":e.uploadFunc,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,"on-preview":e.handleCopy,"on-exceed":e.handleExceed}},[a("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"}},[e._v("点击上传")])],1)],1),a("el-col",{staticStyle:{"text-align":"end",display:"flex","flex-direction":"column","align-items":"center"},attrs:{span:12}},[a("el-button",{attrs:{type:"primary",disabled:e.uploadLink,loading:e.smallLoading},on:{click:e.uploadToChain}},[e._v(e._s(e.upChainText))]),a("el-tag",{directives:[{name:"show",rawName:"v-show",value:!!e.address,expression:"!!address"}],staticStyle:{"margin-top":"10px"},attrs:{type:"info"}},[e._v("上链地址："+e._s(e.address))])],1)],1),a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{type:"flex",justify:"center"}},[a("el-table",{staticStyle:{margin:"0 auto"},attrs:{data:e.tableData,stripe:"",border:""}},[a("el-table-column",{attrs:{"header-align":"center",prop:"path",label:"路径"}}),a("el-table-column",{attrs:{"header-align":"center",prop:"hashcode",label:"HashCode"}})],1)],1)],1),a("el-tab-pane",{attrs:{label:"文件下载"}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{staticStyle:{display:"flex","justify-content":"center"}},[a("el-input",{staticStyle:{width:"40%"},attrs:{placeholder:"请输入文件名称","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleSearch(t):null}},model:{value:e.inputName,callback:function(t){e.inputName=t},expression:"inputName"}}),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{icon:"el-icon-search",type:"primary",loading:e.searchLoading},on:{click:e.handleSearch}},[e._v(e._s(e.searchText))]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showDownload,expression:"showDownload"}],staticStyle:{"margin-left":"20px"},attrs:{icon:"el-icon-download",type:"primary"},on:{click:e.handleDownload}},[e._v("下载")])],1)],1),a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{type:"flex",justify:"center"}},[a("el-table",{staticStyle:{margin:"0 auto"},attrs:{data:e.downloadTableData,stripe:"",border:""}},[a("el-table-column",{attrs:{"header-align":"center",prop:"path",label:"路径"}}),a("el-table-column",{attrs:{"header-align":"center",prop:"hashcode",label:"HashCode"}})],1)],1)],1)],1)},u=[],h=a("XyMi");function p(e){a("+VGo")}var m=!1,f=p,g=null,b=null,y=Object(h["a"])(d,c,u,m,f,g,b),w=y.exports,v=a("mtWM"),x=a.n(v);n["default"].prototype.$http=x.a,x.a.defaults.baseURL="http://localhost:8080",x.a.defaults.headers={"Content-Type":"application/x-www-form-urlencoded"},n["default"].config.productionTip=!1,n["default"].use(l.a),new n["default"]({render:function(e){return e(w)}}).$mount("#app")},tvR6:function(e,t){},uMhA:function(e,t){}},[0]);
//# sourceMappingURL=app.24d61f73.js.map